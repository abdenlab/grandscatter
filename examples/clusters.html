<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>5D Clusters - anyscatter</title>
<style>
	body {
		margin: 0;
		font-family: system-ui, sans-serif;
		background: #f5f5f5;
		display: flex;
		flex-direction: column;
		align-items: center;
		padding: 2rem;
	}
	h1 { margin-bottom: 0.5rem; }
	p { color: #666; margin-top: 0; }
	#plot {
		width: 1028px;
		height: 1028px;
		background: white;
		border: 1px solid #ddd;
		border-radius: 4px;
	}
</style>
</head>
<body>
<h1>anyscatter</h1>
<p>Drag the axis handles to rotate the projection.</p>
<div id="plot"></div>
<script type="module">
import { Scatterplot } from "@anyscatter/core";

// Generate sample data: 3 clusters in 5D
function randn() {
	// Box-Muller transform
	const u = 1 - Math.random();
	const v = Math.random();
	return Math.sqrt(-2 * Math.log(u)) * Math.cos(2 * Math.PI * v);
}

const N = 200; // points per cluster
const dataDim = 5;
const centers = [
	[2, 0, 0, 1, -1],  // Cluster A (red)
	[-1, 2, -1, 0, 1],  // Cluster B (blue)
	[0, -2, 2, -1, 0], // Cluster C (green)
];
// const centers = [
// 	[2, 0, 0],
// 	[-1, 2, -1],
// 	[0, -2, 2],
// ];
const clusterNames = ["Cluster A", "Cluster B", "Cluster C"];
const colors = { "Cluster A": "#e41a1c", "Cluster B": "#377eb8", "Cluster C": "#4daf4a" };

const columns = {};
for (let i = 0; i < dataDim; i++) {
	columns[`x${i + 1}`] = [];
}
const labels = [];
const keys = Object.keys(columns);

for (let c = 0; c < centers.length; c++) {
	for (let i = 0; i < N; i++) {
		for (let d = 0; d < dataDim; d++) {
			columns[keys[d]].push(centers[c][d] + randn() * 0.6);
		}
		labels.push(clusterNames[c]);
	}
}

// Convert to typed arrays
for (const key of keys) {
	columns[key] = new Float64Array(columns[key]);
}

const plot = Scatterplot.create(document.getElementById("plot"), {
	pointSize: 8,
	scaleMode: "center",
	axisLength: 2,
});

plot.loadData({ columns, labels, colors });

// plot.on("projection", (e) => {
// 	console.log("projection changed", e.matrix);
// });
</script>
</body>
</html>
